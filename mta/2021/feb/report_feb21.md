---

author: @linkavych
date: 2022-09-25
link: https://www.malware-traffic-analysis.net/2021/02/08/index.html

---
# Incident Report - Ascolimited - February 2021

## Executive Summary

At 15:59 UTC on 8 February 2021 user Bill Cook opened a malicious Google Document that downloaded Hancitor malware.
Subsequently, the machine was further compromised with a CobaltStrike payload and FickerStealer malware.

## Events and Details

At 15:59 UTC on 8 February 2021 the user Bill Cook visited Google Docs, likely opening a malicious document on his system. The malicious
document issued a `GET` request to `tonmatdoanminh[.]com` to the URI `/uninviting.php` and `/favicon.ico`. These likely downloaded GZIP 
compressed malware related to [Hancitor](https://malpedia.caad.fkie.fraunhofer.de/details/win.hancitor).

<img src="images/init.jpg" width=1000 align=center>

Immediately following this initial download and execution, the malware checks for the public IP
address with a call to `api.ipify.org` and then issues a POST request to a C2 server with that data.
The C2 server is at `satursed[.]com` at IP `213.5.229[.]12`, and the POSt requests follow the format in the below image:

<img src="images/post.jpg" width=1000 align=center>

This communication is followed by a series of downloads from two other webpages: `roanokemortgages[.]com - 8.208.10[.]147` and
`198.211.10.238:8080`. Three downloads for additional shellcode and [FickerStealer](https://malpedia.caad.fkie.fraunhofer.de/details/win.fickerstealer) are made from the former address, while a CobalStrike payload
is downloaded from the latter.

<img src="images/mal.jpg" width=1000 align=center>

The compromised system then begins a consistent encrypted communications pattern with the CobaltStrike C2 server (198.211.10[.]238:8080) for the remainder of the packet capture.
The TLS certificate for this communication is self-generated, with empty fields, as shown below.

<img src="images/c2.jpg" width=1000 align=center>

<img src="images/cert.jpg" width=1000 align=center>

Based on the provided alerts, the analysis above can be generally confirmed. Selected alerts are below:

```text
Count:10 Event#3.768 2021-02-08 16:00 UTC
ETPRO MALWARE Tordal/Hancitor/Chanitor Checkin
10.2.8.101 -> 213.5.229.12
IPVer=4 hlen=5 tos=0 dlen=443 ID=0 flags=0 offset=0 ttl=0 chksum=60612
Protocol: 6 sport=49755 -> dport=80

Seq=0 Ack=0 Off=5 Res=0 Flags=******** Win=0 urp=30910 chksum=0
------------------------------------------------------------------------
Count:1 Event#3.769 2021-02-08 16:00 UTC
ET POLICY HTTP Request on Unusual Port Possibly Hostile
10.2.8.101 -> 198.211.10.238
IPVer=4 hlen=5 tos=0 dlen=40 ID=8878 flags=2 offset=0 ttl=128 chksum=62457
Protocol: 6 sport=49758 -> dport=8080

Seq=2871987428 Ack=1221200613 Off=5 Res=0 Flags=***A**** Win=65535 urp=56826 chksum=0
------------------------------------------------------------------------
Count:3 Event#3.770 2021-02-08 16:00 UTC
ET SHELLCODE Possible TCP x86 JMP to CALL Shellcode Detected
198.211.10.238 -> 10.2.8.101
IPVer=4 hlen=5 tos=0 dlen=159 ID=0 flags=0 offset=0 ttl=0 chksum=54833
Protocol: 6 sport=8080 -> dport=49758

Seq=0 Ack=0 Off=5 Res=0 Flags=******** Win=0 urp=8722 chksum=0
------------------------------------------------------------------------
Count:3 Event#3.774 2021-02-08 16:00 UTC
ET POLICY exe download via HTTP - Informational
10.2.8.101 -> 8.208.10.147
IPVer=4 hlen=5 tos=0 dlen=219 ID=0 flags=0 offset=0 ttl=0 chksum=37972
Protocol: 6 sport=49757 -> dport=80

Seq=0 Ack=0 Off=5 Res=0 Flags=******** Win=0 urp=51520 chksum=0
------------------------------------------------------------------------
Count:5 Event#3.777 2021-02-08 16:00 UTC
ET POLICY Binary Download Smaller than 1 MB Likely Hostile
8.208.10.147 -> 10.2.8.101
IPVer=4 hlen=5 tos=0 dlen=1162 ID=0 flags=0 offset=0 ttl=0 chksum=37029
Protocol: 6 sport=80 -> dport=49757

Seq=0 Ack=0 Off=5 Res=0 Flags=******** Win=0 urp=10912 chksum=0
------------------------------------------------------------------------
Count:5 Event#3.782 2021-02-08 16:00 UTC
ET INFO Packed Executable Download
8.208.10.147 -> 10.2.8.101
IPVer=4 hlen=5 tos=0 dlen=1162 ID=0 flags=0 offset=0 ttl=0 chksum=37029
Protocol: 6 sport=80 -> dport=49757

Seq=0 Ack=0 Off=5 Res=0 Flags=******** Win=0 urp=10912 chksum=0
------------------------------------------------------------------------
Count:1 Event#3.787 2021-02-08 16:00 UTC
ETPRO MALWARE Meterpreter or Other Reverse Shell SSL Cert
198.211.10.238 -> 10.2.8.101
IPVer=4 hlen=5 tos=0 dlen=1176 ID=0 flags=0 offset=0 ttl=0 chksum=53816
Protocol: 6 sport=443 -> dport=49759

Seq=0 Ack=0 Off=5 Res=0 Flags=******** Win=0 urp=21749 chksum=0
------------------------------------------------------------------------
Count:250 Event#3.788 2021-02-08 16:00 UTC
ETPRO MALWARE Cobalt Strike Beacon Observed
10.2.8.101 -> 198.211.10.238
IPVer=4 hlen=5 tos=0 dlen=430 ID=0 flags=0 offset=0 ttl=0 chksum=54562
Protocol: 6 sport=49760 -> dport=8080

Seq=0 Ack=0 Off=5 Res=0 Flags=******** Win=0 urp=9750 chksum=0
------------------------------------------------------------------------
Count:2 Event#3.828 2021-02-08 16:00 UTC
ET MALWARE Win32/Ficker Stealer Activity
185.100.65.29 -> 10.2.8.101
IPVer=4 hlen=5 tos=0 dlen=81 ID=15075 flags=0 offset=0 ttl=128 chksum=62171
Protocol: 6 sport=80 -> dport=49763

Seq=405699802 Ack=3790664959 Off=5 Res=0 Flags=***AP*** Win=64240 urp=46503 chksum=0
------------------------------------------------------------------------
Count:2 Event#3.829 2021-02-08 16:00 UTC
ET MALWARE Win32/Ficker Stealer Activity M3
10.2.8.101 -> 185.100.65.29
IPVer=4 hlen=5 tos=0 dlen=48 ID=11072 flags=2 offset=0 ttl=128 chksum=49823
Protocol: 6 sport=49763 -> dport=80

Seq=3790664959 Ack=405699843 Off=5 Res=0 Flags=***AP*** Win=64199 urp=18464 chksum=0
------------------------------------------------------------------------
```

### Local System Information

- 10.2.8.101
    - Hostname: DESKTOP-MGVG60Z
    - User: Bill Cook
    - Username: bill.cook
    - MAC: 00:12:79:41:c2:aa

### Alerts

<img src="images/alerts.jpg" width=1000 align=center>

## Indicators of Compromise

- 0801.bin - shellcode - ee33a8fa2ae6f6b9366c97ed4c00c2796d98a371249dca725a01aca03caf747b
- 0801s.bin - shellcode -  7af0dc117d2dcd112f50889c4c8a14ac9ee55c2525a24fa66ff9a89b480b7e99
- 6A0v - CobaltStrike - e519c1e99f21fbc6754e2ed9ef38a12684d506617229b4ca87fcff86f6838250
- 6lhjgfdghj.exe - FickerStealer - 94e60de577c84625da69f785ffe7e24c889bfa6923dc7b017c21e8a313e4e8e1
- tonmatdoanminh[.]com - 45.124.85[.]55
- api.ipify.org - Public IP Check
- satursed[.]com - 213.5.229[.]12 - Hancitor C2 - `POST /8/forum.php`
- roanokemortgages[.]com - 8.208.10[.]147 - FickerStealer Downloads
- 198.211.10[.]238:8080 - Cobalt Strike C2 Server - `GET /ca`
