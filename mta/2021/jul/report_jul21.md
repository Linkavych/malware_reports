---

author: @linkavych
date: 2022-10-02
link: https://www.malware-traffic-analysis.net/2021/07/14/index.html

---
# Incident Report - July 2021 - Dualrunning

## Executive Summary

At 20:31 UTC a malicious XLS document was downloaded by Samantha Reed from `insiderushings[.]com:8088`, which contained macros to download additional Dridex malware.

## Detailed Analysis

At UTC 20:31 a GET request is issued to `insiderushings[.]com:8088` and downloads an XLS
document named `Receipt-9650354.xls` and a sha256 hash of `4c56a5a7e49b23fcfab4b8d469d42e583497178b9b237374db3e14289f2afc64`.
[Hatching Triage](https://tria.ge/210714-xtberz3nrj) identifies this file as belonging to the [Dridex]() family of malware, which the alerts also confirm.

<img src="images/alerts.jpg" width=1000 align=center>

<img src="images/macros.jpg" width=1000 align=center>

The XLS macros run a MSHTA script on the compromised system, and additional malware is downloaded from `buyer-remindment[.]com:8088`, which shares the IP of the previous domain
at `185.21.216[.]153`. The new GET request downloads a Windows executable with the sha256 hash of `8e2d3f6bc5f7b639638d2f5ec751bc2985f1636005131623c5d2c448885c5d89` and named `file6.bin`.
This sample is also associated with dridex malware. After this download, C2 communication can be seen going to IPs `202.29.60[.]34`, `72.11.131[.]199`, `45.145.55[.]170:453`, `84.232.252[.]62`, and `207.244.250[.]103`.
Each of these servers has a self-signed TLS certificate with mostly random data for information.

Servers ending with `.103`, `.62`, and `.199` share the following certificate for TLS:

<img src="images/cert_103.jpg" width=1000 align=center>

Server `45.145.55[.]170`:

<img src="images/cert_170.jpg" width=1000 align=center>

Finally, server `202.29.60[.]34`:

<img src="images/cert_34.jpg" width=1000 align=center>

Last, a reverse shell connection was established to server `81.17.23[.]125` over port 443 at 21:59 UTC.

<img src="images/rev.jpg" width=1000 align=center>

### System Information
- IP: 172.16.1.239
- Hostname: DESKTOP-F3P7XLU
- MAC: 00:13:d4:10:05:25
- User: Samantha Reed
- Username: samantha.reed

## Indicators of Compromise

URL for malicious Excel file:
• 185.21.216.153 port 8088 - insiderushings.com:8088 - GET /wp-content/Receipt-9650354.xls?evagk=2MyeEdhGPszYX

URL for initial Dridex DLL:
• 185.21.216.153 port 8088 - buyer-remindment.com:8088 - GET /templates/file6.bin

Dridex post-infection traffic:
- 202.29.60.34 port 443 - HTTPS traffic
- 72.11.131.199 port 443 - HTTPS traffic
- 207.244.250.103 port 443 - HTTPS traffic
- 45.145.55.170 port 453 - HTTPS traffic
- 84.232.252.62 port 443 - HTTPS traffic

Reverse webshell activity:
- 81.17.23.125 port 443 - HTTP traffic

Files
- Receipt-9650354.xls - 4c56a5a7e49b23fcfab4b8d469d42e583497178b9b237374db3e14289f2afc64
- file6.bin - 8e2d3f6bc5f7b639638d2f5ec751bc2985f1636005131623c5d2c448885c5d89
