---

author: @linkavych
date: 2022-09-22
link: https://www.malware-traffic-analysis.net/2021/01/21/index.html

---
# Incident Report - January 2021 - Wokemountain

## Executive Summary

At 23:40 UTC on 20 January 2021, Ursnif malware was downloaded and executed on the system `10.1.21.101` owned by user Orlando McCoy.

## Details

### Local System
- 10.1.21.101
    - Hostname: DESKTOP-NB72TZA
    - MAC: 00:60:67:d3:47:8b
    - User: Orlando McCoy
    - Username: orlando.mccoy

### Summary of Events

At 23:40 UTC on 20 January 2021 the user Orlando McCoy's machine at IP 10.1.21.101 issued a GET request to `209.141.51[.]196`. The
GEt request was issued tot he URI `/Lk9tdZ`, and was redirected by the server to `/files/1.bin` which was a Windows PE file. 
This file is a DLL x86 with the sha 256 hash of `236491cfe870f6b374d80e427ef8f8bfbf24f50d4029128b001d95c8c90845cb`. On [Intezer](https://analyze.intezer.com/analyses/2926aae8-8561-4825-81af-df23363b0dea), [Triage](https://tria.ge/210216-8sa4xvae2j), and [VirusTotal](https://www.virustotal.com/gui/file/236491cfe870f6b374d80e427ef8f8bfbf24f50d4029128b001d95c8c90845cb)
the sample is identified as belonging to the [Ursnif](https://malpedia.caad.fkie.fraunhofer.de/details/win.gozi) family of malware.

<img src="images/init.jpg" width=1000 align=center>

After the initial DLL download, the Ursnif malware reaches out to continue to download more parts packaged as `.rar` archives. 
The RAR archive is downloaded from `162.0.224[.]165` as `/grab32.rar`.
Then the system begins encrypted communication to the IP `193.239.84[.]250`, which has been encrypted with a self-signed TLS
certificate.

<img src="images/c2.jpg" width=1000 align=center>

<img src="images/cert.jpg" width=1000 align=center>

The malware then also starts encrypted communication with IP `84.252.95[.]102` using the same self-signed
TLS certificate. The encrypted communications for Ursnif uses these two IP addresses as targets for the remainder
of the packet capture. However, as shown below, the malware eventually also uses a domain name (that resolves to these addresses) as part of the traffic: 
`booloolo3[.]com` and `booloolo4[.]com`

<img src="images/boo.jpg" width=1000 align=center>

Ursnif also uses the tactic of resolving the public IP address of the target system through DNS calls, which 
can also be found within the pcap data.

<img src="images/pub.jpg" width=1000 align=center>

### Alerts 

<img src="images/alerts.jpg" width=1000 align=center>


## Indicators of Compromise

- 209.141.51[.]196 - GET `/Lk9tdZ/`, GET `/files/1.bin`
- greatewallfirewall[.]xyz - `GET /postfix/[base64 encoded string]` - 185.186.244[.]130
- 162.0.224[.]165 - `GET /grab32.rar`
- 193.239.84[.]250 - Encrypted C2 with self-signed certificate
- 84.252.95[.]102 - Encrypted C2 with self-signed certificate
- booloolo3[.]com
- booloolo4[.]com
- `1.bin` - sha256: 236491cfe870f6b374d80e427ef8f8bfbf24f50d4029128b001d95c8c90845cb
