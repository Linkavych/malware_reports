---

author: @linkavych
date: 2022-09-10
link: https://www.malware-traffic-analysis.net/2020/02/21/index.html

---

# Incident Report - February 2020

At approximately 00:55 UTC on February 21, 2020 a series of alerts were triggered involving the
system located at internal IP address 172.17.8.174 and a series of external IP addresses. Several of the alerts were triggered
multiple times, as shown in the view of the alert panel below. One alert, triggered four times, suggests
the malware that has been downloaded is associated with [Dridex](https://malpedia.caad.fkie.fraunhofer.de/details/win.dridex).

![alerts](images/alerts.jpg)

## Initial Information

- Suspected infection location: 172.17.9.174
- Potential malicious endpoints:
    - 49.51.172[.]56
    - 91.211.88[.]122
    - 205.185.216[.]42
    - 23.1.236[.]92

## General Informaiton and Timeline

The infected Windows system at 172.17.8.174 has a MAC address of `00:11:75:8c:fd:47`, and the
Netbios name of `DESKTOP-TZMKHKC`. The user of this system was likely `Dionyza Simonides` atht eh time the
infection took place, according to LDAP traffic in the packet capture. However, according to kerberos
traffic, the username involved appears to be `gabriella.ventura`.

At approximately 00:55 UTC on 21 February 2020, a DNS query was made for the domain `bluflag.xyz` by
the infected system. This domain was located at `49.51.172[.]56`. The User-Agent for that request was `Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)`.
This user agent suggests the `WinHttp` Windows API was used to make this request to the URI `GET /nCvQOQHCBjZFfiJvyVGA/yrkbdmt.bin`
resulted in a downloaded file. This file is a PE32 executable, with the sha256 hash of: `03c962ebb541a709b92957e301ea03f1790b6a57d4d0605f618fb0be392c8066`.
This initial traffic occured over port 80 as unencrypted HTTP traffic.

Both [Hybrid-Analysis](https://www.hybrid-analysis.com/sample/03c962ebb541a709b92957e301ea03f1790b6a57d4d0605f618fb0be392c8066/5e50a679fc94cb78d778a213) and [Virust Total](https://www.virustotal.com/gui/file/03c962ebb541a709b92957e301ea03f1790b6a57d4d0605f618fb0be392c8066)
detect the file as malicious and identify it as `Graftor` or `Dridex` malware - confirming the alerts.

Subsequent to this download, the infected host begins communicating directly with a system at `91.211.88[.]122`.
This communication is encrypted with a self-signed certificate, as show below.

![cert](images/cert.jpg)

![c2](images/c2start.jpg)

At 1:14 UTC, the compromised system sent data to a server located at `23.1.236[.]125` over port 80.
This initial communication received a `RST` response from the server, and no additional communication is in the
packet capture. This also occured with ip address `23.1.236[.]85`. The compromised system appears to make direct connections
with systems located at `205.185.216[.]42` and `205.185.216[.]10`, which resolve: `tlu.dl.delivery.mp.microsoft.com`. 
These appear to be legitimate Microsoft domains and servers (3rd-party in US), and are likely
false positives for the associated alerts.

## Summary

On February 21, 2020 at 00:55 UTC user `gabriella.ventura` used a Windows 10 endpoint that was compromised
by Dridex malware. The malware was downloaded and executed on the target, likely via a phishing campaign.
The Dridex malware then established persistence on the compromised system and began initial C2 communications
with `91.211.88[.]122`.

## Other Artifacts

In addition to the alerts, we were given a collection fo artifacts from the compromised system for
additional analysis.

- C:\DecemberLogs\Caff54e1.exe
- C:\DecemberLogs\OliviaMatter.vbs
- C:\DecemberLogs\Restaraunt1.cmd
- C:\DecemberLogs\Restaraunt2.cmd
- C:\DecemberLogs\Restaraunt3.cmd
- C:\DecemberLogs\Restaraunt4.cmd
- C:\Users\gabriella.ventura\AppData\Roaming\Microsoft\Spelling\qHD3ZbNtI2b\sigverif.exe
- C:\Users\gabriella.ventura\AppData\Roaming\Microsoft\Spelling\qHD3ZbNtI2b\VERSION.dll
- C:\Users\gabriella.ventura\AppData\Roaming\Microsoft\Templates\LiveContent\16\Ps8EYw7cb1E\iexpress.exe
- C:\Users\gabriella.ventura\AppData\Roaming\Microsoft\Templates\LiveContent\16\Ps8EYw7cb1E\VERSION.dll
- C:\Users\gabriella.ventura\AppData\Roaming\Microsoft\Vault\wRCV5\DUI70.dll
- C:\Users\gabriella.ventura\AppData\Roaming\Microsoft\Vault\wRCV5\WindowsActionDialog.exe
- C:\Users\gabriella.ventura\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\Wiqzbgfwkifvvu.lnk
- C:\Users\gabriella.ventura\Documents\inv_261804.doc
- C:\Windows\System32\Tasks\Jqssmf
- HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\Kxbpbnmslyha

### Word Document
- File: inv_261804.doc
- sha256: 01ea3845eac489a2518962e6a9f968cde0811e1531f5a58718fb02cf62541edc
- Location: c:\users\gabriella.ventura\inv_261804.doc
- Purpose: Initial Dridex downloader, phishing document
- Actions: creates four files named `Restaurant[0-4].cmd` on the target system

### Caff54e1.exe
- sha256: 03c962ebb541a709b92957e301ea03f1790b6a57d4d0605f618fb0be392c8066
- Location: c:\DecemberLogs\Caff54e1.exe
- Download location: http://blueflag[.]xyz/nCvQOQHCBjZFfiJvyVGA/yrkbdmt.bin
- Purpose: Dridex malware installer

### Restaurant[1-4].cmd Files
- Purpose: Configuration data and execution scripts for Dridex
- Location: c:\DecemberLogs\Restaurant[1-4].cmd

### sigverif.exe
- Location: C:\users\gabriella.ventura\AppData\Microsoft\Spelling\qHD3ZbNtI2b\sigverif.exe
- Purpose: Legitimate Windows exe copied to the above location to execute and load Dridex DLLs

### iexpress.exe
- Location: C:\users\gabriella.ventura\AppData\Microsoft\Templates\LiveContent\Ps8EYw7cb1E\iexpress.exe
- Purpose: Legitimate Windows exe used to load Dridex DLLs

### WindowsActionDialog.exe
- Location: C:\users\gabriella.ventura\AppData\Microsoft\Windows\Vault\wRCV5\WindowsActionDialog.exe
- Purpose: Legitimate Windows exe used to load Dridex DLLs

### Version.dll x 2
- Location 1: C:\users\gabriella.ventura\AppData\Microsoft\Spelling\qHD3ZbNtI2b\VERSION.dll
- Purpose: Dridex DLL for sideloading using sigverif.exe.
- Location 2: C:\users\gabriella.ventura\AppData\Microsoft\Templates\LiveContent\Ps8EYw7cb1E\VERSION.dll
- Purpose: Dridex DLL for sideloading using iexpress.exe.

### DUI70.dll
- Location: C:\users\gabriella.ventura\AppData\Microsoft\Vault\wRCV5\DUI70.dll
- Purpose: Dridex DLL loaded by WindowsActionDialog.exe

### Wiqzbgfwkifvvu.lnk
- Location: c:\users\gabriella.ventura\AppData\Roaming\Microsoft\Windows\Start Menu\Program\Startup\Wiqzbgfwkifvvu.lnk
- Purpose: A LNK file placed in the startup folder as a persistence mechanism. The lnk will execute the sigverif.exe chain for persistence.

### Jqssmf
- Purpose: This XML document describes a schedule task installed on the system as a result of the Dridex infection.
    The scheduled task will execute the WindowsActionDialog.exe chain for persistence.
- C:\windows\system32\tasks\Jqssmf

### HKCU\Software\microsoft\Windows\CurrentVersion\Run\Kxbpbnmslyha
- Purpose: Execute the iexpress.exe persistence chain when the system is rebooted.

## Indicators of Compromise

### Host
- `yrkbdmt.bin` (sha256: 03c962ebb541a709b92957e301ea03f1790b6a57d4d0605f618fb0be392c8066)
- See 'Other Artifacts' for addtional indicators.

### Network
- 49.51.172[.]56
- 91.211.88[.]122
- blueflag[.]xyz
- `GET /nCvQOQHCBjZFfiJvyVGA/yrkbdmt.bin`
- UA: `Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5)`

