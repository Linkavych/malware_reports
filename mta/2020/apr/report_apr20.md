---

author: @linkavych
date: 2022-09-11
link: https://www.malware-traffic-analysis.net/2020/04/24/index.html

---
# Incident Report - April 2020

<img src="images/alerts.jpg" width=1000 align=center>

##Question Answers
- 10.0.0.167 - Windows - DESKTOP-GRIONXA - elmer.obrien
- 10.0.0.149 - Windows - DESKTOP-C10SKPY - alyssa.fitzgerald
- 10.0.0.167 was infected.
- The malware associated with this infection was likely Qakbot.

## Summary of Events

At approximately 23:17 UTC on April 23, 2020, user Elmer O'brien downloaded a ZIP archive from `play.astride.ga` at IP address `158.69.28[.]93`
named `Judgement_04222020_318389448.zip`. This file contains a likely malicious VBScript file, which is heavily
obfuscated. The file shares the name of the ZIP archive with the extension `_1663.vbs`.

<img src="images/vbscript.jpg" width=1000 align=center>

After downloading this file, the system makes a number of interesting local domain queries involving
apparently random strings, as shown below:

<img src="images/weird_queries.jpg" width=1000 align=center>

Following this traffic, the system queries for the domain `atn24live.com` at IP address
`104.24.110[.]29`. The system sends an initial `GET` request to this domain with the URI of
`/spool/8888.png?uid=VwBpAG4AZABvAHcAcwAgAEQAZQBmAGUAbgBkAGUAcgAgAC0AIAA2ACwAMgAxACwAMAB8AE0AaQBjAHIAbwBzAG8AZgB0ACAAVwBpAG4AZABvAHcAcwAgADEAMAAgAFAAcgBvAA==`.
This GET request appears to be sending base64 encoded data about the compromised system. In this case:
`Windows Defender - 6.21.0 | Microsoft Windows 10 Pro`. This initial request is redirect to another URI at
the same domain: `cgi-sys/suspendedpage.cgi?uid=VwBpAG4AZABvAHcAcwAgAEQAZQBmAGUAbgBkAGUAcgAgAC0AIAA2ACwAMgAxACwAMAB8AE0AaQBjAHIAbwBzAG8AZgB0ACAAVwBpAG4AZABvAHcAcwAgADEAMAAgAFAAcgBvAA==`.
This same `GET` request is made to several domains until a successful response is had. The other domains
tested for the hosted malware were:

- bg142.calips[.]my - 220.158.200[.]181 - `/spool/888.png?uid=`
- afholdings.com[.]my - 220.158.200[.]181 - `/spool/8888.png?uid=`
- alphapioneer[.]com - 119.31.234[.]4 - `/spool/8888.png?uid=`

This final get request to `alphapioneer[.]com` returns a successful result, and downloads a PE file.
Carving the file from the pcap, the resulting sha256 hash is `e3fbceb124b9fe998699d3ef1276bf3791a19352b1deb8f0d59e78142f43dc7c`.
The file is detected as malicious by most anti-virus engines.

After this download at approximately 23:31 UTC, the compromised system begins encrypted communications with a
server located at IP address `96.248.125[.]34`. This communication is encrypted with a bogus
certificate, commonly associated with Qakbot malware.

<img src="images/cert.34.jpg" width=1000 align=center>

There are other typical signs of Qakbot being the malware, to include the use of encrypted
communications over port 65400 to IP address `54.36.108[.]120`, and the use of checks
to `cdn.speedof.me` - which appear in the pcap.

<img src="images/65400.jpg" width=1000 align=center>


