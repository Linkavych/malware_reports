---

author: @linkavych
date: 2022-09-12
link: https://www.malware-traffic-analysis.net/2020/05/28/index.html

---
# Incident Report - May 2020 Exercise

## Question Answers
1. 10.5.28.229 - Cat-Bomb-W7-PC - phillip.ghent
2. timothy.sizemore - Cat-Bomb-W10-PC
3. phillip.ghent - gh3ntf@st
4. cursor.png - 4e76d73f3b303e481036ada80c2eeba8db2f306cbc9323748560843c80b2fed1, imgpaper.png - 4e76d73f3b303e481036ada80c2eeba8db2f306cbc9323748560843c80b2fed1

## Summary of Events

At approximately 17:56 UTC on May 28, 2020, the system at IP address 10.5.28.229 is exhibiting signs of a Trickbot malware infection.
This system is communicating with a server at `5.1.81[.]68`, which is using a generic
TLS certificate for encryption. This is a probable C2 server for Trickbot malware. Soon after, 
the compromised system begins interacting with another server sharing the same certificate at
IP address `192.3.247[.]116`.

<img src="images/gencert.jpg" width=1000 align=center>

At 18:03 UTC the compromised system send s a `POST` request to the IP address `36.89.106[.]69`.

<img src="images/exfil1.jpg" width=1000 align=center>

A total of four (4) `POST` requests are sent in this short burst of activity. Subsequently,
the comrpomised system begins to interact directly with the domain controller over `port 135`. The attacker then
appears to use LDAP to continue to enumerate the target.

<img src="images/135.jpg" width=1000 align=center>

This interaction is immediately followed by another `POST` request at
18:09 UTC to IP address `203.176.315[.]102:8082`. This post request contains system data related to
the original compromised system. Specifically, the POSt request contains some of the following:

- Hostname: Cat-Bomb-W7-PC
- IP: 10.5.28.229
- MAC: 00:08:02:1C:47:AE
- User: phillip.ghent
- OS: Win 7 Pro
- Other username: timothy.sizemore

After this exchange, the compromised system and the DC begin to exchange data over port 445, and the compromised machine continues to have C2 communication with
a Trickbot C2 server over port 447 at IP `192.3.247[.]116`. Eventually, at 18:10 UTC, the domain controller makes a direct `GET` request to IP address
`162.216.0[.]163` for URI `/ico/VidT6cErs`. This get request retrieves encrypted data
from the server.

<img src="images/encrypt.jpg" width=1000 align=center>

The original compromised workstation also makes the same `GET` request to the same server, but appears to download
a different encrypted payload. Both the DC and workstation then send `GET` requests to get their public
IP addresses from `icanhazip[.]com` and `wtfismyip[.]com` respectively.

The compromised workstation downloads two files, which are PE files, at 18:11 UTC and 18:14 UTC from `162.216.0[.]163`.
The files are named `imgpaper.png` and `cursor.png`. The sha256sums are:

- imgpaper.png - 934c84524389ecfb3b1dfcb28f9697a2b52ea0ebcaa510469f0d2d9086bcc79a
- cursor.png - 4e76d73f3b303e481036ada80c2eeba8db2f306cbc9323748560843c80b2fed1

Finally, at 18:17 the domain controller makes a `POST` request to `203.176.315[.]102:8082` to exfiltrate
more sensitive data from the network.

<img src="images/summary.jpg" width=1000 align=center>
