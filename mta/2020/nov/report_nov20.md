---

author: @linkavych
date: 2022-09-19
link: https://www.malware-traffic-analysis.net/2020/11/13/index.html

---
# Incident Report - November 2020 - Quiethub

## Executive Summary

At 00:26 UTC IP 192.168.200.8 began exhibiting signs of compromise from malware associated with IcedID.
Encrypted C2 was observed with multiple servers associated with IcedID. At 09:39 UTC a Cobal Strike beacon was downloaded to the target system
and used to likely interrogate the network further, and exfiltrate date. During this period, at 09:46 UTC, the compromised target
conducted a `SYN` scan on port 445 for the IP range `198.211.99.0/24`. Following this scan, normal C2 traffic resumed for an IcedID and Cobalt Strike compromise.

## Details of Events

At 00:26 UTC on 13 November 2020 the system associated with the user `Craig Alda` at IP `192.168.200.8` made an initial `GET` request
to `205.185.113[.]20` at the URI `/BVd1qKwd`. This request was redirected to the URI `/files/3.dll` and downloaded a Windows DLL. The DLL
is associated with [IcedID](https://malpedia.caad.fkie.fraunhofer.de/details/win.icedid) malware family, and is tagged as such in [Malware Bazaar]()https://bazaar.abuse.ch/browse.php?search=sha256%3Addcf95d87542f2df67aff8941fcd92c71cc704698b00923791e21285f82bb01a.

After the DLL is downloaded, the compromised system begins making multiple DNS requests for non-standard TLD domains. Specifically, `lezasopedrill[.]cyou, timerdisclaimer[.]pw, and compactmuslimsdeport[.]pw`. These 
domains resolve to `143.110.191[.]95, 198.211.99[.]24, and 198.211.99[.]24` respectively. Additionally, both of these IP addresses are using default TLS certificates.

<img src="images/nov_dns.jpg" width=1000 align=center>

<img src="images/nov_cert.jpg" width=1000 align=center>

Encrypted communication is established using the `compactmuslimsdeport[.]pw` domain and IP address, and continues throughout the remainder of the PCAP.
At 09:39 UTC, the compromised system issues a `GET` request to `185.141.24[.]71` at the URI `/download/winnit.exe`. This file has a hash of `7801b75f545c24cf7fba8e98dc4505d21c1a11fd228d04685f714d2a0bef83f0`
and is associated with Cobalt Strike. The system then begins C2 communications with the same IP address, but using the domain `webintercom76delivery[.]net` in a series of `GET` and `POST`
requests.

<img src="images/nov_cobalt.jpg" width=1000 align=center>

Following this C2 traffic, the compromised system conducts a `SYN` scan against port 445 for the range of IP
addresses within the CIDR `198.211.99.0/24`. Then the system returns to normal CS C2 patterns and C2 associated with IcedID.

<img src="images/nov_syn.jpg" width=1000 align=center>

## Local Systems
- 192.168.200.8
    - Hostname: DESKTOP-JH1UZAE
    - MAC: 00:08:02:1c:47:ae
    - User: Craig Alda
    - Username: craig.alda

### Alerts

<img src="images/nov_alerts.jpg" width=1000 align=center>

## Indicators of Compromise

- Filename: 3.dll
    - location: c:\syuHKYt/vFPKnDV/VSMecyU.dll
    - sha256: ddcf95d87542f2df67aff8941fcd92c71cc704698b00923791e21285f82bb01a
    - size: 134656 bytes
    - type: Windows x86 DLL

- Filename: winnit.exe
    - Location: c:\Users/craig.alda/AppData/Local/Temp/tezehu.exe
    - sha256: 7801b75f545c24cf7fba8e98dc4505d21c1a11fd228d04685f714d2a0bef83f0
    - size: 734720 bytes
    - type: x86 EXE Windows

- Filename: ~2457218.tmp
    - location: c:\users\craig.alda\AppData\Local\Temp\
    - sha256: 70db47bd97fc2d27b51eada6b24e32462d6144601a852347c0f6276db62430a6
    - size: 130375
    - type: PNG

- Filename: ~2559312.dll
    - location: Users/craig.alda/AppData/Local/Temp/~2559312.dll
    - sha256: d25e3a7ed538968e9b78367cd8f8d20f8f55471a1eb27aae2774272fc8c1c1ce
    - size: 125952
    - type: x86 DLL

- Filename: sqlite64.dll
    - location: Users/craig.alda/AppData/Local/Temp/sqlite64.dll
    - sha256: fca6b7fe66ad9973f18f407e83b56dacd04197cbd35efc498a342d73d6a113e5
    - size: 1902080
    - type: x86-64 DLL

- Filename: Maaywuku2.dll
    - location: c:\Users/craig.alda/AppData/Roaming/craig.alda/Maaywuku2.dll
    - sha256: a09d8c487a135b973af532247d62f46695a53f37add6c66e561f1c14650290f5
    - type: DLL x86

- Filename: baipuyac.png
    - location: Users/craig.alda/AppData/Roaming/Exijopac/uwsida3/baipuyac.png
    - sha256: cc1030c4c7486f5295444acb205fa9c9947ad41427b6b181d74e7e5fe4e6f8a9
    - type: PNG

- Filename: CV.xlsb
    - location: C:\users\craig.alda\Documents\
    - sha256: d9bf5e572d313ddf6f684e93874333e68d493395dc032a1d77c250018a31548f
    - type: Microsoft Excel

- Filename: {5FD47D96-5062-7DE3-08DA-938D00A84B6B}
    - location: C:\Windows\System32\Tasks\
    - sha256: 670b57b4e4625b726ea8f4eb716bb838252f4afad05aa1dc252ec07223273a74
    - type: XML 1.0

### Scheduled Task
```xml
<?xml version="1.0" encoding="UTF-16"?>
<Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task">
  <RegistrationInfo>
    <URI>\{5FD47D96-5062-7DE3-08DA-938D00A84B6B}</URI>
  </RegistrationInfo>
  <Triggers>
    <TimeTrigger id="TimeTrigger">
      <Repetition>
        <Interval>PT1H</Interval>
        <StopAtDurationEnd>false</StopAtDurationEnd>
      </Repetition>
      <StartBoundary>2012-01-01T12:00:00</StartBoundary>
      <Enabled>true</Enabled>
    </TimeTrigger>
    <LogonTrigger id="LogonTrigger">
      <Enabled>true</Enabled>
      <UserId>craig.alda</UserId>
    </LogonTrigger>
  </Triggers>
  <Settings>
    <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>
    <DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries>
    <StopIfGoingOnBatteries>false</StopIfGoingOnBatteries>
    <AllowHardTerminate>false</AllowHardTerminate>
    <StartWhenAvailable>true</StartWhenAvailable>
    <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>
    <IdleSettings>
      <Duration>PT10M</Duration>
      <WaitTimeout>PT1H</WaitTimeout>
      <StopOnIdleEnd>true</StopOnIdleEnd>
      <RestartOnIdle>false</RestartOnIdle>
    </IdleSettings>
    <AllowStartOnDemand>true</AllowStartOnDemand>
    <Enabled>true</Enabled>
    <Hidden>false</Hidden>
    <RunOnlyIfIdle>false</RunOnlyIfIdle>
    <WakeToRun>false</WakeToRun>
    <ExecutionTimeLimit>PT0S</ExecutionTimeLimit>
    <Priority>7</Priority>
  </Settings>
  <Actions Context="Author">
    <Exec>
      <Command>regsvr32.exe</Command>
      <Arguments>/s "C:\Users\craig.alda\AppData\Roaming\craig.alda\Maaywuku2.dll"</Arguments>
    </Exec>
  </Actions>
  <Principals>
    <Principal id="Author">
      <UserId>QUIETHUB\craig.alda</UserId>
      <LogonType>InteractiveToken</LogonType>
      <RunLevel>LeastPrivilege</RunLevel>
    </Principal>
  </Principals>
</Task>
```
