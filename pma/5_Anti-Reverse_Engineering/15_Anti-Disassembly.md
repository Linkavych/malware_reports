# Anti-Disassembly

## Lab 15-1

Analyze the sample found in the file Lab15-01.exe. This is a command-line
program that takes an argument and prints “Good Job!” if the argument
matches a secret code.

1. What anti-disassembly technique is used in this binary?

> False conditional branches: `xor eax, eax` following by a `jz`.

2. What rogue opcode is the disassembly tricked into disassembling?

> 0xE8

3. How many times is this technique used?

> Five times.

4. What command-line argument will cause the program to print “Good Job!”?

> 'pdq'


## Lab 15-2

Analyze the malware found in the file Lab15-02.exe. Correct all anti-disassembly
countermeasures before analyzing the binary in order to answer the questions.

1. What URL is initially requested by the program?

> http://www[.]practicalmalwareanalysis[.]com/bamboo.html

2. How is the User-Agent generated?

> The call to `gethostname` will generate the User-Agent for the sample. The hostname will have 1 added to each character or number in the hostname.

3. What does the program look for in the page it initially requests?

> Looks for the text: 'Bamboo::'.

4. What does the program do with the information it extracts from the page?

> Write the information to a file and then executes the file. The file will be named: `Account Summary.xls.exe'.


## Lab 15-3

Analyze the malware found in the file Lab15-03.exe. At first glance, this binary
appears to be a legitimate tool, but it actually contains more functionality
than advertised.

1. How is the malicious code initially called?

> The code is called initially by overwriting the return from the WinMain function.

2. What does the malicious code do?

> Downloads a file and executes the file with WinExec.

3. What URL does the malware use?

> http://www[.]practicalmalwareanalysis[.]com/tt.html

4. What filename does the malware use?

> spoolsrv.exe
